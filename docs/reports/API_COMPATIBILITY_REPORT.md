# å‰åç«¯APIæ¥å£å­—æ®µå…¼å®¹æ€§æŠ¥å‘Š

**æ£€æŸ¥æ—¥æœŸ**: 2026-01-01
**æ£€æŸ¥èŒƒå›´**: æ‰€æœ‰å‰åç«¯APIæ¥å£
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## æ‰§è¡Œæ‘˜è¦

å·²å…¨é¢æ£€æŸ¥æ‰€æœ‰7ä¸ªæ¨¡å—çš„APIæ¥å£ï¼Œå‘ç°å¹¶ä¿®å¤äº†**2ä¸ªæ¨¡å—**çš„å­—æ®µä¸åŒ¹é…é—®é¢˜ï¼š

1. âœ… **å•†å“ç®¡ç†** - 6ä¸ªå­—æ®µæ˜ å°„é—®é¢˜å·²ä¿®å¤
2. âœ… **è®¢å•ç®¡ç†** - 5ä¸ªå‚æ•°åé—®é¢˜å·²ä¿®å¤
3. âœ… å…¶ä»–5ä¸ªæ¨¡å— - æ— éœ€ä¿®æ”¹

---

## å·²ä¿®å¤çš„é—®é¢˜

### 1. å•†å“ç®¡ç†æ¥å£

**æ–‡ä»¶**: `vue-admin/src/api/product.ts`

#### 1.1 è·å–å•†å“åˆ—è¡¨å‚æ•°è½¬æ¢
```typescript
// å‰ç«¯ä½¿ç”¨ â†’ åç«¯æœŸæœ›
category (å­—ç¬¦ä¸²) â†’ category_id (æ•´æ•°)
status ("active"/"inactive") â†’ is_active (å¸ƒå°”å€¼)
pageSize â†’ page_size
```

#### 1.2 åˆ›å»º/æ›´æ–°å•†å“å­—æ®µæ˜ å°„
```typescript
// å‰ç«¯å­—æ®µ â†’ åç«¯å­—æ®µ
name â†’ title
category (å­—ç¬¦ä¸²) â†’ category_id (æ•´æ•°)
status â†’ is_active
image â†’ local_image_path + image_url
```

#### 1.3 åº“å­˜æ›´æ–°å­—æ®µä¿®å¤
```typescript
// ä¿®å¤å‰
export const updateStock = (id: number, stock: number) => {
  return request.patch(`/admin/products/${id}/stock`, { stock })
}

// ä¿®å¤å
export const updateStock = (id: number, adjustment: number) => {
  return request.patch(`/admin/products/${id}/stock`, { stock_adjustment: adjustment })
}

// å‰ç«¯è®¡ç®—è°ƒæ•´é‡
const adjustment = stockForm.stock - stockForm.originalStock
```

### 2. è®¢å•ç®¡ç†æ¥å£

**æ–‡ä»¶**: `vue-admin/src/api/order.ts`

#### 2.1 è·å–è®¢å•åˆ—è¡¨å‚æ•°è½¬æ¢
```typescript
// å‰ç«¯ä½¿ç”¨ â†’ åç«¯æœŸæœ›
pageSize â†’ page_size
orderNo â†’ order_no
userName â†’ user_name
startDate â†’ start_date
endDate â†’ end_date
```

**å®ç°æ–¹å¼**:
```typescript
export const getOrderList = async (params: OrderQuery) => {
  const requestParams: any = {
    page: params.page,
    page_size: params.pageSize,  // è½¬æ¢
  }

  if (params.orderNo) {
    requestParams.order_no = params.orderNo  // è½¬æ¢
  }

  if (params.userName) {
    requestParams.user_name = params.userName  // è½¬æ¢
  }

  // ... å…¶ä»–å­—æ®µè½¬æ¢
}
```

---

## æ¥å£æ£€æŸ¥è¯¦æƒ…

| æ¨¡å— | æ¥å£æ•°é‡ | å­—æ®µåŒ¹é… | ä¿®å¤é—®é¢˜ | çŠ¶æ€ |
|------|----------|----------|----------|------|
| ç”¨æˆ·è®¤è¯ | 3ä¸ª | âœ… å®Œå…¨åŒ¹é… | 0ä¸ª | âœ… æ— éœ€ä¿®æ”¹ |
| å•†å“ç®¡ç† | 6ä¸ª | âš ï¸ éƒ¨åˆ†ä¸åŒ¹é… | 6ä¸ª | âœ… å·²ä¿®å¤ |
| è®¢å•ç®¡ç† | 5ä¸ª | âš ï¸ éƒ¨åˆ†ä¸åŒ¹é… | 5ä¸ª | âœ… å·²ä¿®å¤ |
| åˆ†ç±»ç®¡ç† | 4ä¸ª | âœ… å®Œå…¨åŒ¹é… | 0ä¸ª | âœ… æ— éœ€ä¿®æ”¹ |
| ç”¨æˆ·ç®¡ç† | 3ä¸ª | âœ… å®Œå…¨åŒ¹é… | 0ä¸ª | âœ… æ— éœ€ä¿®æ”¹ |
| è¯„ä»·ç®¡ç† | 3ä¸ª | âœ… åŒ¹é…ä½†æœªä½¿ç”¨ | 0ä¸ª | âš ï¸ å‰ç«¯å¾…å®ç° |
| ç»Ÿè®¡æ•°æ® | 3ä¸ª | âœ… å®Œå…¨åŒ¹é… | 0ä¸ª | âœ… æ— éœ€ä¿®æ”¹ |

**æ€»è®¡**: 27ä¸ªæ¥å£ï¼Œ26ä¸ªå·²å®Œå…¨å…¼å®¹ï¼Œ1ä¸ªå¾…å‰ç«¯å®ç°

---

## æœ€ä½³å®è·µå»ºè®®

ä¸ºé¿å…å°†æ¥å‡ºç°å­—æ®µä¸åŒ¹é…é—®é¢˜ï¼Œå»ºè®®éµå¾ªä»¥ä¸‹è§„èŒƒï¼š

### 1. å‘½åè§„èŒƒç»Ÿä¸€

**å‰ç«¯ â†’ åç«¯å‘½åè½¬æ¢è§„åˆ™**:
- `camelCase` (å‰ç«¯) â†’ `snake_case` (åç«¯)
- `pageSize` â†’ `page_size`
- `orderNo` â†’ `order_no`
- `userName` â†’ `user_name`

### 2. ç±»å‹è½¬æ¢è§„èŒƒ

| å‰ç«¯ç±»å‹ | åç«¯ç±»å‹ | è½¬æ¢ç¤ºä¾‹ |
|---------|---------|---------|
| `status: "active"` | `is_active: true` | `is_active = status === 'active'` |
| `category: "ä¸»é£Ÿ"` | `category_id: 3` | æŸ¥æ‰¾åˆ†ç±»ID |
| `stock: 50` | `stock_adjustment: +10` | `adjustment = newStock - oldStock` |

### 3. APIå¼€å‘æµç¨‹

æ–°å¢APIæ—¶å»ºè®®éµå¾ªï¼š
1. âœ… å…ˆå®šä¹‰åç«¯Schemaå’ŒAPI
2. âœ… åœ¨å‰ç«¯APIæ–‡ä»¶ä¸­æ·»åŠ å‚æ•°è½¬æ¢
3. âœ… æµ‹è¯•å‰åç«¯è”è°ƒ
4. âœ… æ›´æ–°æœ¬æ–‡æ¡£

### 4. ä»£ç å®¡æŸ¥æ£€æŸ¥ç‚¹

å®¡æŸ¥APIè°ƒç”¨ä»£ç æ—¶æ£€æŸ¥ï¼š
- [ ] å‚æ•°åæ˜¯å¦ç¬¦åˆåç«¯æœŸæœ›
- [ ] å­—æ®µç±»å‹æ˜¯å¦åŒ¹é…
- [ ] æ˜¯å¦éœ€è¦å‚æ•°è½¬æ¢
- [ ] æ˜¯å¦å¤„ç†äº†å¯é€‰å‚æ•°
- [ ] é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„

---

## ä¿®æ”¹æ–‡ä»¶æ¸…å•

### å·²ä¿®æ”¹çš„æ–‡ä»¶
1. âœ… `vue-admin/src/api/product.ts` - å•†å“ç®¡ç†API
2. âœ… `vue-admin/src/api/order.ts` - è®¢å•ç®¡ç†API
3. âœ… `vue-admin/src/views/Products.vue` - åº“å­˜æ›´æ–°é€»è¾‘

### æ— éœ€ä¿®æ”¹çš„æ–‡ä»¶
- âœ… `vue-admin/src/api/user.ts` - ç”¨æˆ·è®¤è¯API
- âœ… `vue-admin/src/api/category.ts` - åˆ†ç±»ç®¡ç†API
- âœ… `vue-admin/src/api/review.ts` - è¯„ä»·ç®¡ç†API
- âœ… `vue-admin/src/api/dashboard.ts` - ç»Ÿè®¡æ•°æ®API

---

## æµ‹è¯•éªŒè¯

### å·²éªŒè¯æ¥å£
- âœ… ç”¨æˆ·ç™»å½•/ç™»å‡º
- âœ… å•†å“åˆ—è¡¨æŸ¥è¯¢ï¼ˆå«ç­›é€‰ï¼‰
- âœ… å•†å“åˆ›å»º/æ›´æ–°
- âœ… åº“å­˜æ›´æ–°
- âœ… è®¢å•åˆ—è¡¨æŸ¥è¯¢ï¼ˆå«ç­›é€‰ï¼‰
- âœ… è®¢å•çŠ¶æ€æ›´æ–°
- âœ… åˆ†ç±»CRUDæ“ä½œ
- âœ… ç»Ÿè®¡æ•°æ®è·å–

### æµ‹è¯•å‘½ä»¤
```bash
# æµ‹è¯•åº“å­˜æ›´æ–°API
curl -X PATCH 'http://localhost:8001/api/admin/products/1/stock' \
  -H "Authorization: Bearer $TOKEN" \
  -H 'Content-Type: application/json' \
  -d '{"stock_adjustment": 10}'
```

---

## åç»­ä¼˜åŒ–å»ºè®®

### é«˜ä¼˜å…ˆçº§
1. âš ï¸ **å®ç°è¯„ä»·ç®¡ç†å‰ç«¯é¡µé¢**
   - åç«¯æ¥å£å·²å°±ç»ª
   - å‰ç«¯éœ€æ·»åŠ è¯„ä»·åˆ—è¡¨ã€å›å¤ã€åˆ é™¤åŠŸèƒ½

2. ğŸ“ **å®Œå–„TypeScriptç±»å‹å®šä¹‰**
   - å‡å°‘ä½¿ç”¨ `any` ç±»å‹
   - å®šä¹‰æ›´ä¸¥æ ¼çš„æ¥å£ç±»å‹

### ä¸­ä¼˜å…ˆçº§
3. ğŸ”§ **åˆ›å»ºç»Ÿä¸€å‚æ•°è½¬æ¢å·¥å…·**
   ```typescript
   // ç¤ºä¾‹ï¼šç»Ÿä¸€å‚æ•°è½¬æ¢å·¥å…·
   export function transformParams<T>(params: T, mapping: Record<string, string>) {
     const result: any = {}
     for (const [key, value] of Object.entries(params)) {
       const newKey = mapping[key] || key
       result[newKey] = value
     }
     return result
   }
   ```

4. ğŸ“Š **æ·»åŠ APIè°ƒç”¨æ—¥å¿—**
   - å¼€å‘ç¯å¢ƒè®°å½•æ‰€æœ‰APIè°ƒç”¨
   - ä¾¿äºè°ƒè¯•å­—æ®µä¸åŒ¹é…é—®é¢˜

### ä½ä¼˜å…ˆçº§
5. ğŸ“š **ç¼–å†™APIæ–‡æ¡£**
   - ä½¿ç”¨Swagger/OpenAPIè‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£
   - å‰åç«¯å›¢é˜Ÿå…±äº«æ–‡æ¡£

---

## ç»“è®º

âœ… **æ‰€æœ‰æ ¸å¿ƒAPIæ¥å£å­—æ®µåŒ¹é…é—®é¢˜å·²è§£å†³**

æœ¬æ¬¡æ£€æŸ¥ç¡®ä¿äº†å‰åç«¯APIçš„å®Œå…¨å…¼å®¹æ€§ï¼Œé¿å…äº†å› å­—æ®µä¸åŒ¹é…å¯¼è‡´çš„è°ƒç”¨å¤±è´¥ã€‚æœªæ¥æ–°å¢APIæ—¶è¯·å‚è€ƒæœ¬æ–‡æ¡£çš„æœ€ä½³å®è·µå»ºè®®ã€‚

---

**æ£€æŸ¥äººå‘˜**: Claude AI
**æœ€åæ›´æ–°**: 2026-01-01
