---
name: 外卖app
description: 快餐连锁店自有外卖配送系统，包含Flutter移动端用户App、Vue3管理后台和Python后端API
status: backlog
created: 2025-12-31T13:18:05Z
---

# PRD: 快餐连锁店自有外卖配送系统

## Executive Summary

为单一快餐连锁品牌打造的自有外卖配送平台，旨在减少对第三方外卖平台的依赖，提升用户体验和品牌粘性。系统包含Flutter移动端用户App、Vue3管理后台和Python后端API服务，支持外卖配送和到店自取两种订单类型，目标首期日订单量100-500单。

## Problem Statement

### 当前痛点
- **高昂佣金成本**：第三方外卖平台抽成15-25%，严重压缩餐厅利润空间
- **用户数据流失**：用户属于平台而非餐厅，难以进行精准营销和用户运营
- **品牌曝光不足**：在第三方平台上品牌独立性弱，难以建立差异化形象
- **服务体验不可控**：配送服务质量依赖第三方，影响品牌声誉

### 为什么是现在
- 外卖市场规模持续增长，用户习惯已养成
- 技术成熟度高，开发成本可控
- 疫情后餐饮数字化需求激增
- 竞争压力下需要建立自有私域流量

## User Stories

### 核心用户群体

#### 1. 普通顾客（C端用户）
**画像**：20-35岁，白领/学生，习惯移动支付，追求便捷快速

**主要用户旅程**：
- 浏览菜单 → 选择商品 → 加入购物车 → 选择配送方式 → 下单支付 → 等待订单 → 收餐/取餐 → 评价

**核心诉求**：
- 快速找到想吃的商品
- 下单流程简单流畅
- 订单状态实时可查
- 会员优惠活动

#### 2. 餐厅管理员/店员（B端用户）
**画像**：餐厅店长/员工，负责接单、制作、配送管理

**主要用户旅程**：
- 登录后台 → 查看新订单 → 确认接单 → 安排制作 → 更新订单状态 → 安排配送/等待自取 → 完成订单

**核心诉求**：
- 及时接收订单通知
- 清晰的订单信息展示
- 高效的订单处理流程
- 统计数据查看

#### 3. 餐厅管理者（管理端用户）
**画像**：餐厅老板/运营经理，需要数据分析和管理

**主要用户旅程**：
- 查看销售报表 → 分析热销商品 → 调整菜单 → 设置促销活动 → 查看用户评价

**核心诉求**：
- 销售数据可视化
- 菜单管理便捷
- 用户反馈收集
- 营销活动管理

### 详细用户故事

#### 用户App端
```
作为顾客，我希望能够：
- 浏览分类清晰的菜单，快速找到想吃的商品
- 查看商品详情、价格、图片和销量
- 将商品加入购物车并调整数量
- 选择外卖配送或到店自取
- 使用模拟支付完成订单（后期对接真实支付）
- 实时查看订单状态（已接单/制作中/配送中/已完成）
- 查看历史订单记录
- 对已完成的订单进行评分和文字评价
- 编辑个人资料和查看订单地址
```

**验收标准**：
- 菜单加载时间 < 2秒
- 下单流程不超过5步
- 订单状态延迟 < 5秒
- 支持至少100个并发用户

#### 后台管理系统
```
作为餐厅管理员，我希望能够：
- 查看所有订单列表（按时间/状态筛选）
- 查看订单详情（商品、金额、用户、配送信息）
- 接受/拒绝订单
- 手动更新订单状态
- 管理菜单（添加/编辑/下架商品）
- 查看销售统计数据（日/周/月）
- 查看和处理用户评价
- 管理商品分类
```

**验收标准**：
- 订单通知延迟 < 10秒
- 订单状态更新实时同步到用户端
- 数据报表查询响应 < 3秒
- 支持多个管理员同时登录

## Requirements

### Functional Requirements - 用户App（Flutter）

#### 1. 用户认证模块
- **FR-1.1** 手机号注册/登录
- **FR-1.2** 验证码验证（暂时使用模拟验证码：1234）
- **FR-1.3** 自动登录（Token持久化）
- **FR-1.4** 退出登录

#### 2. 菜单浏览模块
- **FR-2.1** 首页展示商品分类列表（横向滚动）
- **FR-2.2** 点击分类切换对应商品列表
- **FR-2.3** 商品卡片展示：图片、名称、价格、销量
- **FR-2.4** 商品详情页：大图、详细描述、规格选择
- **FR-2.5** 搜索商品（按名称模糊搜索）
- **FR-2.6** 商品收藏功能

#### 3. 购物车模块
- **FR-3.1** 添加商品到购物车
- **FR-3.2** 调整商品数量（+/-按钮）
- **FR-3.3** 删除购物车商品
- **FR-3.4** 购物车商品列表展示
- **FR-3.5** 购物车总金额实时计算
- **FR-3.6** 清空购物车

#### 4. 下单流程
- **FR-4.1** 确认订单页面（商品清单、金额、配送方式）
- **FR-4.2** 选择配送方式（外卖配送 / 到店自取）
- **FR-4.3** 外卖订单填写配送地址和联系电话
- **FR-4.4** 到店自取订单填写取餐人姓名和电话
- **FR-4.5** 选择备注信息（如少辣、不要香菜等）
- **FR-4.6** 模拟支付功能（点击"支付"后自动成功）
- **FR-4.7** 支付成功后跳转到订单详情

#### 5. 订单管理模块
- **FR-5.1** 订单列表（全部/进行中/已完成）
- **FR-5.2** 订单详情页（订单号、商品、金额、状态）
- **FR-5.3** 订单状态展示：
  - 待接单（商家未处理）
  - 制作中（商家已接单）
  - 配送中/待取餐（根据配送方式）
  - 已完成
  - 已取消
- **FR-5.4** 订单状态实时刷新（轮询或WebSocket）
- **FR-5.5** 取消订单功能（仅待接单状态可取消）

#### 6. 评价模块
- **FR-6.1** 已完成订单显示"评价"按钮
- **FR-6.2** 评分组件（星级1-5分）
- **FR-6.3** 文字评价输入（最多200字）
- **FR-6.4** 上传图片（可选，最多3张）
- **FR-6.5** 提交评价
- **FR-6.6** 查看商品的评价列表

#### 7. 个人中心
- **FR-7.1** 用户头像和昵称展示
- **FR-7.2** 我的订单入口
- **FR-7.3** 收货地址管理
- **FR-7.4** 联系客服入口
- **FR-7.5** 关于我们

### Functional Requirements - 后台管理系统（Vue3）

#### 8. 管理员认证
- **FR-8.1** 管理员账号密码登录
- **FR-8.2** 权限管理（超级管理员/普通管理员）
- **FR-8.3** 操作日志记录

#### 9. 订单管理
- **FR-9.1** 订单列表（支持按时间、状态、配送方式筛选）
- **FR-9.2** 新订单声音/弹窗通知
- **FR-9.3** 查看订单详情
- **FR-9.4** 接受/拒绝订单
- **FR-9.5** 手动更新订单状态
- **FR-9.6** 订单导出（Excel/CSV）

#### 10. 菜单管理
- **FR-10.1** 商品分类管理（增删改查）
- **FR-10.2** 商品管理：
  - 添加商品（名称、价格、图片、描述、分类、库存）
  - 编辑商品信息
  - 上架/下架商品
  - 设置商品销量
- **FR-10.3** 商品图片上传（支持多图）

#### 11. 数据统计
- **FR-11.1** 今日概览（订单数、营业额、平均客单价）
- **FR-11.2** 销售趋势图（近7天/30天）
- **FR-11.3** 热销商品排行（按销量/金额）
- **FR-11.4** 配送方式统计（外卖/自取比例）
- **FR-11.5** 评价统计（平均分、评价数量）

#### 12. 用户管理
- **FR-12.1** 用户列表（按注册时间、订单数筛选）
- **FR-12.2** 查看用户详情（订单历史、总消费）
- **FR-12.3** 用户标签管理

#### 13. 评价管理
- **FR-13.1** 评价列表（按时间、评分筛选）
- **FR-13.2** 查看评价详情
- **FR-13.3** 回复用户评价
- **FR-13.4** 删除违规评价

### Functional Requirements - 后端API（Python）

#### 14. 用户相关API
- **FR-14.1** POST /api/auth/register - 用户注册
- **FR-14.2** POST /api/auth/login - 用户登录
- **FR-14.3** GET /api/user/profile - 获取用户信息
- **FR-14.4** PUT /api/user/profile - 更新用户信息

#### 15. 商品相关API
- **FR-15.1** GET /api/categories - 获取分类列表
- **FR-15.2** GET /api/products - 获取商品列表（支持分类筛选、搜索）
- **FR-15.3** GET /api/products/:id - 获取商品详情
- **FR-15.4** GET /api/products/:id/reviews - 获取商品评价

#### 16. 购物车API
- **FR-16.1** GET /api/cart - 获取购物车
- **FR-16.2** POST /api/cart - 添加商品到购物车
- **FR-16.3** PUT /api/cart/:itemId - 更新购物车商品数量
- **FR-16.4** DELETE /api/cart/:itemId - 删除购物车商品
- **FR-16.5** DELETE /api/cart - 清空购物车

#### 17. 订单相关API
- **FR-17.1** POST /api/orders - 创建订单
- **FR-17.2** GET /api/orders - 获取用户订单列表
- **FR-17.3** GET /api/orders/:id - 获取订单详情
- **FR-17.4** PUT /api/orders/:id/cancel - 取消订单
- **FR-17.5** POST /api/orders/:id/review - 提交订单评价

#### 18. 管理后台API
- **FR-18.1** POST /api/admin/login - 管理员登录
- **FR-18.2** GET /api/admin/orders - 获取所有订单
- **FR-18.3** PUT /api/admin/orders/:id/status - 更新订单状态
- **FR-18.4** GET /api/admin/products - 商品管理
- **FR-18.5** POST /api/admin/products - 创建商品
- **FR-18.6** PUT /api/admin/products/:id - 更新商品
- **FR-18.7** GET /api/admin/statistics - 获取统计数据

### Non-Functional Requirements

#### 性能要求（NFR-1）
- **NFR-1.1** 用户App启动时间 < 3秒
- **NFR-1.2** API接口响应时间：
  - 一般接口 < 500ms
  - 数据查询接口 < 1秒
  - 报表统计接口 < 3秒
- **NFR-1.3** 支持并发用户数：
  - MVP阶段：100并发
  - 目标阶段：500并发
- **NFR-1.4** 数据库查询优化，所有查询 < 100ms

#### 安全要求（NFR-2）
- **NFR-2.1** 所有API接口必须进行身份认证（JWT Token）
- **NFR-2.2** 密码使用bcrypt加密存储
- **NFR-2.3** API接口防刷限制（Rate Limiting）
- **NFR-2.4** 敏感操作需要验证（修改密码、支付等）
- **NFR-2.5** HTTPS加密传输（生产环境）
- **NFR-2.6** SQL注入防护
- **NFR-2.7** XSS攻击防护

#### 可用性要求（NFR-3）
- **NFR-3.1** 系统可用性 ≥ 99%
- **NFR-3.2** 数据库定期备份（每日自动备份）
- **NFR-3.3** 错误日志记录和监控
- **NFR-3.4** 优雅降级：部分功能故障不影响核心下单流程

#### 可维护性要求（NFR-4）
- **NFR-4.1** 代码遵循PEP8规范
- **NFR-4.2** API文档自动生成（Swagger/OpenAPI）
- **NFR-4.3** 单元测试覆盖率 ≥ 70%
- **NFR-4.4** 代码版本控制（Git）
- **NFR-4.5** 清晰的错误码定义

#### 可扩展性要求（NFR-5）
- **NFR-5.1** 后端采用模块化架构，易于添加新功能
- **NFR-5.2** 数据库设计支持未来功能扩展（如会员系统、优惠券）
- **NFR-5.3** 支持未来接入真实支付系统（微信支付、支付宝）
- **NFR-5.4** 预留第三方配送平台对接接口

#### 用户体验要求（NFR-6）
- **NFR-6.1** 界面简洁美观，符合Material Design规范
- **NFR-6.2** 操作流程简单直观，新用户无需教程即可使用
- **NFR-6.3** 加载状态友好提示（Skeleton/Loading动画）
- **NFR-6.4** 网络异常友好提示和重试机制
- **NFR-6.5** 支持暗黑模式（可选）

## Success Criteria

### 业务指标
- **SC-1** 首月上线后，日订单量达到50单
- **SC-2** 用户好评率 ≥ 4.5分（满分5分）
- **SC-3** 订单完成率 ≥ 95%
- **SC-4** 用户留存率（次月复购）≥ 30%
- **SC-5** 平均下单时长（从打开App到支付成功）≤ 3分钟

### 技术指标
- **SC-6** API接口成功率 ≥ 99.5%
- **SC-7** App崩溃率 < 1%
- **SC-8** 页面加载95分位响应时间 < 2秒
- **SC-9** 零重大安全事故（数据泄露、资金损失）

### 用户体验指标
- **SC-10** 用户满意度评分 ≥ 4.0分
- **SC-11** 客服投诉率 < 5%
- **SC-12** 订单取消率 < 10%

## Constraints & Assumptions

### 技术约束
- **C-1** 移动端必须使用Flutter框架开发
- **C-2** 后端必须使用Python开发（建议使用FastAPI或Django REST Framework）
- **C-3** 数据库使用PostgreSQL或MySQL
- **C-4** 图片存储使用对象存储服务（如阿里云OSS或腾讯云COS）
- **C-5** 首期不接入真实支付系统，使用模拟支付

### 资源约束
- **C-6** 开发团队规模：3人（1个Flutter开发 + 1个Vue3开发 + 1个Python后端开发）
- **C-7** MVP开发周期：6-8周
- **C-8** 服务器预算：每月 ≤ ¥2000（云服务器 + 数据库 + 存储 + CDN）

### 业务约束
- **C-9** 首期仅支持单一餐厅品牌，不支持多商户
- **C-10** 首期不支持外卖配送员端App（由餐厅内部管理配送）
- **C-11** 暂不支持会员积分和优惠券系统
- **C-12** 暂不支持预定订单（仅支持立即下单）

### 假设条件
- **A-1** 餐厅已有稳定的配送团队或配送合作伙伴
- **A-2** 用户已习惯使用移动App点餐
- **A-3** 餐厅具备基本的网络环境和智能设备
- **A-4** 后期会接入真实支付系统
- **A-5** 后期可能扩展到多门店模式
- **A-6** 高峰期订单量可能达到平时的3-5倍

## Out of Scope

以下功能**明确不在MVP范围内**：

### 用户端功能
- **OOS-1** 会员积分系统
- **OOS-2** 优惠券/满减活动
- **OOS-3** 预定订单（提前预订未来时间）
- **OOS-4** 拼单功能
- **OOS-5** 智能推荐算法
- **OOS-6** 社交分享功能
- **OOS-7** 实时配送地图追踪
- **OOS-8** 多门店切换
- **OOS-9** 在线客服聊天
- **OOS-10** 餐排号功能

### 商家端功能
- **OOS-11** 专用骑手App
- **OOS-12** 配送路线规划
- **OOS-13** 智能调度系统
- **OOS-14** 库存管理（进销存）
- **OOS-15** 财务对账系统
- **OOS-16** 营销活动管理器
- **OOS-17** 多门店管理
- **OOS-18** 员工权限管理

### 技术功能
- **OOS-19** 真实支付系统接入（微信支付、支付宝）
- **OOS-20** 短信验证码服务（使用模拟验证码）
- **OOS-21** 消息推送服务（如极光推送）
- **OOS-22** 数据大屏展示
- **OOS-23** AI客服机器人
- **OOS-24** 数据分析高级功能（用户画像、预测分析）

以上功能可在后续迭代中根据需求优先级逐步实现。

## Dependencies

### 外部依赖
- **D-1** 云服务器（阿里云ECS / 腾讯云CVM）
- **D-2** 数据库服务（云数据库或自建PostgreSQL/MySQL）
- **D-3** 对象存储服务（用于存储商品图片）
- **D-4** CDN加速（可选，用于图片加速）
- **D-5** 域名和SSL证书

### 内部依赖
- **D-6** 餐厅提供商品信息和图片素材
- **D-7** 餐厅提供门店信息和配送范围
- **D-8** 餐厅指定管理员账号
- **D-9** 餐厅提供Logo和品牌素材

### 开发依赖
- **D-10** Flutter SDK（≥ 3.0）
- **D-11** Dart SDK（≥ 2.17）
- **D-12** Node.js 16+ 和 npm/yarn/pnpm（Vue3开发）
- **D-13** Python 3.9+
- **D-14** Git版本控制
- **D-15** API测试工具（Postman / curl）

### 团队依赖
- **D-16** Flutter移动端开发者
- **D-17** Vue3前端开发者
- **D-18** Python后端开发者
- **D-19** UI/UX设计师（可选，可使用现成UI组件库）
- **D-20** 测试人员（可由开发人员兼任）

### 技术栈建议
**移动端（Flutter）**
- 状态管理：Provider / Riverpod / Bloc
- 网络请求：Dio
- 本地存储：Hive / SharedPreferences
- UI组件：Material Design 3

**管理后台（Vue3）**
- 核心框架：Vue 3 + TypeScript
- 构建工具：Vite
- UI组件库：Element Plus / Ant Design Vue / Naive UI
- 状态管理：Pinia
- 路由：Vue Router 4
- HTTP客户端：Axios
- 图表库：ECharts / Chart.js（用于数据可视化）
- 实时通信：WebSocket / Socket.io（订单通知）

**后端（Python）**
- Web框架：FastAPI / Django REST Framework
- ORM：SQLAlchemy / Django ORM
- 数据库迁移：Alembic / Django Migrations
- 认证：JWT（PyJWT / djangorestframework-simplejwt）
- 文档：Swagger / OpenAPI

**数据库**
- PostgreSQL（推荐）或 MySQL 8.0+
- Redis（可选，用于缓存和会话管理）

**部署**
- 容器化：Docker + Docker Compose
- 反向代理：Nginx
- 进程管理：Supervisor / Gunicorn

## Technical Architecture Overview

### 系统架构
```
┌─────────────────────────────────────────────────┐
│                    用户层                        │
│  ┌──────────────┐      ┌──────────────────┐    │
│  │ Flutter App  │      │  Vue3管理后台     │    │
│  │ (iOS + Android)    │      │        │
│  └──────────────┘      └──────────────────┘    │
└─────────────────────────────────────────────────┘
                        │ HTTPS/API
                        ▼
┌─────────────────────────────────────────────────┐
│                  应用层                          │
│  ┌──────────────────────────────────────────┐  │
│  │        Python后端API服务                 │  │
│  │  (FastAPI / Django REST Framework)       │  │
│  └──────────────────────────────────────────┘  │
└─────────────────────────────────────────────────┘
                        │
                        ▼
┌─────────────────────────────────────────────────┐
│                  数据层                          │
│  ┌──────────┐  ┌──────────┐  ┌─────────────┐  │
│  │PostgreSQL│  │  Redis   │  │  对象存储    │  │
│  │  主数据库 │  │  缓存    │  │  图片/文件   │  │
│  └──────────┘  └──────────┘  └─────────────┘  │
└─────────────────────────────────────────────────┘
```

### 核心业务流程
1. **用户下单流程**：浏览菜单 → 加入购物车 → 确认订单 → 模拟支付 → 生成订单 → 商家接单 → 制作/配送 → 完成 → 评价
2. **商家接单流程**：接收订单通知 → 查看订单详情 → 接受/拒绝 → 更新订单状态 → 通知用户
3. **数据统计流程**：订单完成 → 记录统计数据 → 后台展示报表

---

## Next Steps

本PRD已完成需求收集和分析，建议下一步：

1. **技术方案设计**：详细设计数据库Schema、API接口定义
2. **UI/UX设计**：设计App界面和交互流程
3. **开发排期**：制定详细的开发计划和里程碑
4. **开始开发**：执行 `/pm:prd-parse 外卖app` 创建Epic并分解任务
