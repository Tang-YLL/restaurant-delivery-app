---
id: 11
title: iOS平台配置和构建
status: pending
priority: high
labels: [flutter, ios, build]
assigned:
estimate: 16h
dependencies: [6, 7]
---

# 任务011: iOS平台配置和构建

## 目标
配置Flutter项目的iOS平台，确保可以在iOS设备上运行，并满足App Store发布要求。

## 背景说明
PRD新增要求：Flutter应用必须同时支持iOS和Android双平台。当前Flutter项目已完成基础开发，需要配置iOS平台并进行构建测试。

## 详细任务

### 1. iOS开发环境配置 (2h)
- [ ] 验证Xcode安装（要求 ≥ 14.0）
- [ ] 验证Flutter iOS开发环境
  ```bash
  flutter doctor
  flutter doctor --verbose
  ```
- [ ] 安装CocoaPods（如果需要）
  ```bash
  sudo gem install cocoapods
  ```
- [ ] 验证iOS Simulator可用

### 2. Flutter iOS配置 (4h)
- [ ] 检查 `flutter_app/ios/` 目录结构
- [ ] 配置 `ios/Runner/Info.plist`
  - 设置Bundle Identifier
  - 配置权限说明（相机、相册、通知等）
  - 设置App名称和版本号
- [ ] 配置 `ios/Runner.xcodeproj` 项目设置
  - 设置iOS部署目标（≥ iOS 12.0）
  - 配置签名和证书（开发阶段）
- [ ] 更新 `ios/Podfile`（如果需要）

### 3. iOS特定功能实现 (4h)
- [ ] 适配iOS安全区域（SafeArea）
- [ ] 配置iOS推送通知权限
- [ ] 适配iOS手势和导航（返回手势）
- [ ] 配置iOS图标和启动屏幕
  - 使用 `flutter_launcher_icons` 包
  - 生成iOS应用图标
- [ ] 适配iOS深色模式（如果支持）

### 4. iOS构建和测试 (4h)
- [ ] 在iOS Simulator上运行测试
  ```bash
  flutter run -d ios
  ```
- [ ] 验证所有核心功能在iOS上正常工作
  - 登录注册
  - 商品浏览
  - 购物车
  - 下单支付
  - 订单管理
  - 评价功能
  - 个人中心
- [ ] 测试iOS特定功能
  - 推送通知权限请求
  - 相机/相册权限请求
  - SafeArea适配
- [ ] 性能测试
  - App启动时间
  - 页面切换流畅度
  - 内存占用

### 5. iOS Release构建配置 (2h)
- [ ] 配置iOS签名证书（Development/Distribution）
- [ ] 配置Provisioning Profile
- [ ] 创建Archive配置
- [ ] 测试Release构建
  ```bash
  flutter build ios --release
  ```
- [ ] 验证Release版本功能正常

## 验收标准

### 必须满足
- [ ] ✅ Flutter Doctor显示iOS环境正常
- [ ] ✅ App可以在iOS Simulator上成功运行
- [ ] ✅ 所有核心功能在iOS上测试通过
- [ ] ✅ iOS SafeArea正确适配
- [ ] ✅ iOS权限请求正常工作
- [ ] ✅ Release构建成功
- [ ] ✅ App图标和启动屏幕正确显示

### 可选
- [ ] 真机测试通过
- [ ] 性能指标达标（启动时间 < 3秒）
- [ ] 内存占用 < 150MB

## 技术细节

### iOS权限配置示例
```xml
<!-- ios/Runner/Info.plist -->
<key>NSCameraUsageDescription</key>
<string>需要访问相机来拍摄菜品评价照片</string>

<key>NSPhotoLibraryUsageDescription</key>
<string>需要访问相册来选择评价照片</string>

<key>NSPhotoLibraryAddUsageDescription</key>
<string>需要保存照片到相册</string>

<key>UIBackgroundModes</key>
<array>
    <string>remote-notification</string>
</array>
```

### Bundle Identifier配置
```
com.restaurant.deliveryapp
```

### iOS部署目标
```
IPHONEOS_DEPLOYMENT_TARGET = 12.0
```

## 依赖关系
- 依赖任务006（Flutter基础框架）
- 依赖任务007（Flutter核心功能）
- 可与任务012（Android配置）并行执行

## 工作目录
```
/Volumes/545S/general final/flutter_app
```

## 注意事项
1. iOS开发需要macOS环境
2. 真机测试需要Apple Developer账号（$99/年）
3. Simulator测试不需要开发者账号
4. 首次iOS构建可能需要较长时间（下载依赖）

## 下一步
完成iOS配置后，继续进行App Store发布准备（任务014）
